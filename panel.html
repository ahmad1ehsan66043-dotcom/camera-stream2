<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ú©Ù†ØªØ±Ù„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Tahoma, sans-serif;
        }
        
        body {
            background: #0d1117;
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: #161b22;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #30363d;
        }
        
        h1 {
            color: #58a6ff;
            margin-bottom: 10px;
        }
        
        .status-bar {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .status-card {
            background: #161b22;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #30363d;
        }
        
        .status-value {
            font-size: 24px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .green {
            color: #3fb950;
        }
        
        .red {
            color: #f85149;
        }
        
        .video-container {
            background: #000;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid #30363d;
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #capturedImage {
            max-width: 100%;
            max-height: 400px;
            border-radius: 10px;
            display: none;
        }
        
        .placeholder {
            color: #8b949e;
            font-size: 18px;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .control-btn {
            padding: 15px 30px;
            background: #21262d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #30363d;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 180px;
            justify-content: center;
        }
        
        .control-btn:hover {
            background: #30363d;
            border-color: #58a6ff;
        }
        
        .capture-btn {
            background: linear-gradient(135deg, #1f6feb 0%, #388bfd 100%);
        }
        
        .record-btn {
            background: linear-gradient(135deg, #da3633 0%, #f85149 100%);
        }
        
        .download-btn {
            background: linear-gradient(135deg, #238636 0%, #2ea043 100%);
        }
        
        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .image-item {
            background: #161b22;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #30363d;
        }
        
        .image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .image-info {
            padding: 10px;
            font-size: 12px;
            color: #8b949e;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #238636;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <div class="container">
        <header>
            <h1>ğŸ® Ù¾Ù†Ù„ Ú©Ù†ØªØ±Ù„ Ø¯ÙˆØ±Ø¨ÛŒÙ†</h1>
            <p>ğŸ“± Ø¯ÙˆØ±Ø¨ÛŒÙ† Ú¯ÙˆØ´ÛŒ Ø±Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø§ÛŒÙ† Ù¾Ù†Ù„ Ú©Ù†ØªØ±Ù„ Ú©Ù†ÛŒØ¯</p>
        </header>
        
        <div class="status-bar">
            <div class="status-card">
                <div>ÙˆØ¶Ø¹ÛŒØª Ø¯ÙˆØ±Ø¨ÛŒÙ†</div>
                <div class="status-value red" id="cameraStatus">âŒ ØºÛŒØ±ÙØ¹Ø§Ù„</div>
            </div>
            
            <div class="status-card">
                <div>ØªØµØ§ÙˆÛŒØ± Ø«Ø¨Øª Ø´Ø¯Ù‡</div>
                <div class="status-value" id="imageCount">0</div>
            </div>
            
            <div class="status-card">
                <div>Ø¢Ø®Ø±ÛŒÙ† ØªØµÙˆÛŒØ±</div>
                <div class="status-value" id="lastCapture">--</div>
            </div>
        </div>
        
        <div class="video-container">
            <div class="placeholder" id="placeholder">
                ğŸ“· ØªØµÙˆÛŒØ±ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            </div>
            <img id="capturedImage" alt="ØªØµÙˆÛŒØ± Ø«Ø¨Øª Ø´Ø¯Ù‡">
        </div>
        
        <div class="controls">
            <button class="control-btn capture-btn" onclick="simulateCapture()">
                <span>ğŸ“¸</span>
                Ø«Ø¨Øª ØªØµÙˆÛŒØ±
            </button>
            
            <button class="control-btn download-btn" onclick="downloadLastImage()" id="downloadBtn" disabled>
                <span>â¬‡ï¸</span>
                Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¢Ø®Ø±ÛŒÙ† ØªØµÙˆÛŒØ±
            </button>
            
            <button class="control-btn" onclick="clearAllImages()">
                <span>ğŸ—‘ï¸</span>
                Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡
            </button>
        </div>
        
        <div>
            <h3>ğŸ“ ØªØµØ§ÙˆÛŒØ± Ø«Ø¨Øª Ø´Ø¯Ù‡:</h3>
            <div class="images-grid" id="imagesGrid">
                <!-- ØªØµØ§ÙˆÛŒØ± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </div>
    </div>
    
    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§
        let capturedImages = JSON.parse(localStorage.getItem('capturedImages') || '[]');
        let lastImageData = null;
        
        // Ø¹Ù†Ø§ØµØ± DOM
        const cameraStatus = document.getElementById('cameraStatus');
        const imageCount = document.getElementById('imageCount');
        const lastCapture = document.getElementById('lastCapture');
        const capturedImage = document.getElementById('capturedImage');
        const placeholder = document.getElementById('placeholder');
        const downloadBtn = document.getElementById('downloadBtn');
        const imagesGrid = document.getElementById('imagesGrid');
        const notification = document.getElementById('notification');
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        updateDisplay();
        
        // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¯ÙˆØ±Ø¨ÛŒÙ†
        function checkCameraStatus() {
            const isActive = localStorage.getItem('cameraActive') === 'true';
            cameraStatus.textContent = isActive ? 'âœ… ÙØ¹Ø§Ù„' : 'âŒ ØºÛŒØ±ÙØ¹Ø§Ù„';
            cameraStatus.className = isActive ? 'status-value green' : 'status-value red';
            
            if (!isActive) {
                showNotification('Ù„Ø·ÙØ§Ù‹ ØµÙØ­Ù‡ Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø±Ø§ Ø±ÙˆÛŒ Ú¯ÙˆØ´ÛŒ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯');
            }
        }
        
        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø«Ø¨Øª ØªØµÙˆÛŒØ±
        function simulateCapture() {
            // Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© ØªØµÙˆÛŒØ± Ù†Ù…ÙˆÙ†Ù‡
            const canvas = document.createElement('canvas');
            canvas.width = 800;
            canvas.height = 600;
            const ctx = canvas.getContext('2d');
            
            // Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Ù…ØªÙ†
            ctx.fillStyle = '#4cc9f0';
            ctx.font = '40px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ğŸ“¸ ØªØµÙˆÛŒØ± Ø«Ø¨Øª Ø´Ø¯Ù‡', canvas.width/2, canvas.height/2 - 50);
            
            ctx.fillStyle = 'white';
            ctx.font = '20px Arial';
            ctx.fillText('ØªØ§Ø±ÛŒØ®: ' + new Date().toLocaleString('fa-IR'), canvas.width/2, canvas.height/2);
            ctx.fillText('Ø´Ù…Ø§Ø±Ù‡: ' + (capturedImages.length + 1), canvas.width/2, canvas.height/2 + 40);
            
            // ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Data URL
            const imageData = canvas.toDataURL('image/jpeg');
            
            // Ø°Ø®ÛŒØ±Ù‡
            const imageInfo = {
                id: Date.now(),
                data: imageData,
                timestamp: new Date().toLocaleString('fa-IR'),
                filename: `capture-${Date.now()}.jpg`
            };
            
            capturedImages.unshift(imageInfo); // Ø§Ø¶Ø§ÙÙ‡ Ø¨Ù‡ Ø§ÙˆÙ„ Ù„ÛŒØ³Øª
            localStorage.setItem('capturedImages', JSON.stringify(capturedImages));
            
            lastImageData = imageData;
            
            // Ù†Ù…Ø§ÛŒØ´
            capturedImage.src = imageData;
            capturedImage.style.display = 'block';
            placeholder.style.display = 'none';
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
            updateDisplay();
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯
            downloadBtn.disabled = false;
            
            showNotification('âœ… ØªØµÙˆÛŒØ± Ø«Ø¨Øª Ø´Ø¯');
        }
        
        // Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¢Ø®Ø±ÛŒÙ† ØªØµÙˆÛŒØ±
        function downloadLastImage() {
            if (!lastImageData) return;
            
            const link = document.createElement('a');
            link.href = lastImageData;
            link.download = `capture-${Date.now()}.jpg`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('â¬‡ï¸ ØªØµÙˆÛŒØ± Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯');
        }
        
        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ ØªØµØ§ÙˆÛŒØ±
        function clearAllImages() {
            if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ ØªØµØ§ÙˆÛŒØ± Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ')) {
                capturedImages = [];
                localStorage.setItem('capturedImages', '[]');
                updateDisplay();
                capturedImage.style.display = 'none';
                placeholder.style.display = 'block';
                downloadBtn.disabled = true;
                showNotification('ğŸ—‘ï¸ Ù‡Ù…Ù‡ ØªØµØ§ÙˆÛŒØ± Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯');
            }
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
        function updateDisplay() {
            imageCount.textContent = capturedImages.length;
            
            if (capturedImages.length > 0) {
                lastCapture.textContent = capturedImages[0].timestamp;
            } else {
                lastCapture.textContent = '--';
            }
            
            // Ù†Ù…Ø§ÛŒØ´ ØªØµØ§ÙˆÛŒØ±
            imagesGrid.innerHTML = '';
            
            capturedImages.forEach(image => {
                const div = document.createElement('div');
                div.className = 'image-item';
                div.innerHTML = `
                    <img src="${image.data}" alt="ØªØµÙˆÛŒØ±">
                    <div class="image-info">
                        <div>${image.timestamp}</div>
                    </div>
                `;
                imagesGrid.appendChild(div);
            });
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
        function showNotification(message) {
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¯ÙˆØ±Ø¨ÛŒÙ†
        setInterval(checkCameraStatus, 5000);
        checkCameraStatus(); // Ø§ÙˆÙ„ Ø¨Ø§Ø±
    </script>
</body>
</html>